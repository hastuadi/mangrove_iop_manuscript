---
title: Satellite-based Mangrove species abundance estimate using Machine Learning ensemble
author: Hastuadi Harsa, Gathot Winarso, Kuncoro Teguh Setiawan and  Wikanti Asriningrum
alamat: Remote Sensing Research Center - Research Organization for Aeronautics and Space Indonesia National Research and Innovation Agency

abstrak: The mangrove ecosystem is a vital feature in a coastal area, playing a critical role in carbon sequestration beneath the soil. Carbon preservation capacity varies among different species of mangrove. Thus, by quantifying the number of mangrove species in a given area, the volume of carbon sequestered can be estimated. Satellite imagery is a highly effective tool for gathering such data across vast territories. In this study, we present an evaluation of mangrove species abundance across a large coastal area using Landsat satellite imagery. To achieve this, we employed machine learning algorithms to classify species based on spectral field observation data. These algorithms were trained individually and ensembled to enhance prediction performance. There are 136 models generated in a two-hour training phase. After assessing these models, we identified that a stacked ensemble consisting of Deep Learning, two Distributed Random Forests, Generalized Linear Model, and Extreme Gradient Boosting algorithms, has superior predictive accuracy. The model achieved a Root Mean Squared Error value of 0.283 when tested to the observational data. After applying this model to the satellite data, our results indicate that Rhizophora Apiculata and Avicennia alba are the two most abundant mangrove species in the study area, covering 25.6% and 10.9%, respectively.
output: 
  bookdown::pdf_document2:
    keep_tex: true
    template: templateiop.tex
    pandoc_args: ["-r", "markdown-auto_identifiers"]

# header-includes:
#   -\usepackage{booktabs}
#   -\usepackage{longtable}
#   -\usepackage{array}
#   -\usepackage{multirow}
#   -\usepackage{wrapfig}
#   -\usepackage{float}
#   -\usepackage{colortbl}
#   -\usepackage{pdflscape}
#   -\usepackage{tabu}
#   -\usepackage{threeparttable}
#   -\usepackage{threeparttablex}
#   -\usepackage[normalem]{ulem}
#   -\usepackage{makecell}
#   -\usepackage{xcolor}
---

# Introduction

Carbon trading serves as a climate change mitigation strategy by creating economic incentives for reducing greenhouse gas emissions \cite{Zheng2023}. The approach enables industries and countries to trade carbon credits, allowing those exceeding emission reduction targets to sell surplus credits to entities struggling to meet their targets \cite{Xu2023}\cite{Ke2023}. By valuing carbon emissions and facilitating their market-driven reduction, carbon trading promotes sustainable practices and contributes to overall emission reductions.

Mangrove forests, characterized by their unique coastal ecosystems, are known for their exceptional capacity to sequester and store carbon. These ecosystems, comprising mangrove trees and associated vegetation, act as a vital carbon preserver by absorbing atmospheric carbon dioxide (CO2) and retaining it within their biomass and sediments. Mangrove plants possess the ability to sequester carbon at rates several times higher than terrestrial forests, making them crucial allies in climate change mitigation efforts.

However, accurately estimating the carbon stock of mangrove forests requires an understanding of the different carbon sequestration potentials among various mangrove species. Different species exhibit varying levels of biomass and different growth rates, directly impacting their carbon storage capacity. Hence, the identification and quantification of mangrove coverage, accounting for species-level variations, become essential for precise carbon stock assessments.

In recent years, remote sensing techniques, particularly the use of satellite imagery, have revolutionized ecological studies by providing a cost-effective and efficient means of mapping large areas. Satellite imagery enables the identification and monitoring of mangrove forests at regional and global scales, facilitating comprehensive assessments of carbon stock estimates. Integrating satellite imagery with Artificial Intelligence (AI) algorithms allows for advanced analysis of spectral bands to predict mangrove species, aiding in species-specific carbon stock calculations.

This paper describes the use of AI for predicting mangrove species from Landsat satellite imagery bands. Therefore, the estimate of carbon stock can also be measured subsequently using the information given by the predicted mangrove species abundance.

# Data and methods

![(#fig:studyarea)The study area, located at the west part of Sumatra, Indonesia, were within the intersection of available satellite data scene and the geospatial mangrove vector area.](images/studyarea2.png)

The study area was located within the Sembilang National Park in Banyuasin Regency, along the east coast of Sumatra, Indonesia. The area covered by a red rectangle at the top-left of Figure \@ref(fig:studyarea) shows the study area. This study collected three distinct data types: the mangrove area represented as polygons in a geospatial vector format file, field-observation data, and Landsat satellite data. The Indonesia Ministry of Environment and Forestry obtained the geospatial vector data. The data determined the boundary of the mangrove area. The field-observation data were collected within the mangrove area, employing a spectrometer instrument. The instrument displayed the spectral characteristics of mangrove leaves at selected sampling locations. Each observed mangrove leaf was analyzed across seven distinct spectral bands to unveil a comprehensive understanding of its unique attributes. The measurement values the spectrometer gave, and the observed mangrove leaf species were then recorded. Eventually, the observation data contained eight variables, i.e., seven bands of spectrums and their related species. In the measurement process, only the broadest leaf in the neighborhood was selected as the sample data and there were 21 mangrove species identified in the study area.

The satellite data were obtained from a single Landsat Satellite imagery scene and covered some geospatial vector data. The data were represented in a geospatial raster format. The raster had a homogeneous spatial resolution of approximately 30 meters. The superposition of satellite data and the geospatial vector data are displayed at the bottom-left of Figure 1. The satellite data also contained seven bands, as in the field observation data. Both observation and satellite data bands were referred to as B1 to B7, as the abbreviation of a band and its corresponding satellite sensor. The distinction between the observed and satellite data was that the observed data contained eight variables, while the satellite data contained only seven. The eighth variable of the observation data was labeled as 'class,' denoting the species of each observed mangrove leaf. A composition of Red-Green-Blue (RGB) bands of satellite raster data is displayed on the right side of Figure 1. This image illustrates a true color composition as a visible color spectrum. The RGB values were denoted by B1, B2, and B3 for Blue, Green, and Red colors, respectively. The red polygon reveals the overlapping area between the mangrove geospatial vector and satellite raster data.

The main effort in estimating the mangrove species' abundance was presenting an absent variable to the satellite data, which was present in the observation data. The absent variable was the eighth variable, i.e., class. Since the class variable was the dependent variable of each datum in the observation data, it was essential to extract the underlying interaction optimally among all band variables as the independent variables. The satellite bands interaction characterized the class variable. In Machine Learning (ML) terms, this process is known as classification. This study employed some ML algorithms to build models that extract the underlying relationship between the independent and the dependent variables of observation data.

Before building the model, all values of the independent variables in the observation data were standardized to have zero mean and a standard deviation of one. By standardizing the independent variables, all independent variables would have the same amount of contribution to the model building. In addition, the standardization procedure would exaggerate the interaction pattern among variables. The standardized observation data were then duplicated into 20 folds to provide a cross-validation element. Each fold was separated into two components: training and validation. The ratio of training and validation for all folds was 80% and 20%, respectively. The order of training and validation data were chosen randomly within each fold.

The standardized observation data were then fed to the ML algorithms as training data. The algorithms chosen in this study were Distributed Random Forest (DRF), Generalized Linear Model (GLM), Extreme Gradient Boosting (XGBoost), Generalized Boosting Machine (GBM), and Deep Learning (DL). This ML algorithm each had different model parameters. All algorithms were trained multiple times using various configurations following the needs of each algorithm's parameter. Each algorithm setup produced a single model. The models were stored for further performance comparison. A total of two-hour training sessions was designated as the maximum training time. Models with good performance were also ensembled to outperform each algorithm's best model.

One final best model was then chosen from the model's collection. This model was adopted to predict mangrove species at pixels of the satellite bands data. The satellite bands data were also standardized first as the training data. The prediction was performed only on the pixels located inside the mangrove polygons. All predicted species were then tabulated to estimate the abundance of species within the mangrove polygons.

# Results and discussion

![(#fig:performance)The performance of the top-10 best models out of 136 sorted by their accuracy.](images/top_10.png){width="275" height="236"}

There were 21 mangrove species collected in the field observation spectral data. The modeling of the band's spectral combination value in composing the species yielded 136 models. Their accuracy sorted the performance of the models. The accuracy was determined as the mean percentage of correct species classification from the 20 folds cross-validation of the observation data. The best model was a stacked ensemble composed of six base models. These base models were each one of DL, DRF, GBM, and XGBoost models and two DRF models. The meta-learner algorithm for ensembling these base models was a GLM algorithm. The accuracy of the best model was 96.2%, as shown in Figure \@ref(fig:performance).

![(#fig:prediction)The best model classification prediction](images/prediction2-01.png){width="546" height="466"} 

The mangrove species classification prediction output is displayed by Figure \@ref(fig:prediction).

\noindent \begin{center}
\begin{tabular}{crr@{\extracolsep{0pt}.}lr@{\extracolsep{0pt}.}l}
\br 
Species  & Pixel count  & \multicolumn{2}{c}{Percentage } & \multicolumn{2}{c}{Coverage (Hectare) }\tabularnewline
\hline
Rhizophora Apiculata  & 216693  & 17&71  & 195&02\tabularnewline
Excoecaria agallocha  & 128331  & 10&49  & 115&50\tabularnewline
Sonneratia ovata  & 121761  & 9&95  & 109&58\tabularnewline
Avicennia officinalis  & 101432  & 8&29  & 91&29\tabularnewline
Ceriops tagal  & 96629  & 7&90  & 86&97\tabularnewline
Avicennia alba  & 86897  & 7&10  & 78&21\tabularnewline
Derris trifoliata  & 71376  & 5&83  & 64&24\tabularnewline
Bruguiera cylindrica  & 68186  & 5&57  & 61&37 \tabularnewline
Rhizophora mucronata  & 64220  & 5&25  & 57&80 \tabularnewline
Xylocarpus granatum  & 53867  & 4&40  & 48&48 \tabularnewline
Bruguiera parviflora  & 51098  & 4&18  & 45&99 \tabularnewline
Nypa fruticans  & 36129  & 2&95  & 32&52 \tabularnewline
Sonneratia alba  & 29928  & 2&45  & 26&94 \tabularnewline
Acrostichum speciosum  & 29282  & 2&39  & 26&35 \tabularnewline
Avicennia marina  & 18256  & 1&49  & 16&43 \tabularnewline
Bruguiera sexangula  & 16083  & 1&31  & 14&47 \tabularnewline
Acrostichum aureum  & 10411  & 0&85  & 9&37 \tabularnewline
Acanthus ilicifolius  & 9181  & 0&75  & 8&26 \tabularnewline
Bruguiera gymnorrhiza  & 6378  & 0&52  & 5&74 \tabularnewline
Rhizophora stylosa  & 5680  & 0&46  & 5&11 \tabularnewline
Acrostichum sp  & 1667  & 0&14  & 1&50\tabularnewline
\br
\end{tabular}
\par\end{center}

# Conclusion

An estimate method of mangrove species abundance has been presented in this paper. The method
